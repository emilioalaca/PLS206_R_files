{
    "contents" : "# Discriminant analysis using MASS\n#  Loosely based on http://www.statmethods.net/advstats/discriminant.html by  Robert I. Kabacoff\nlibrary(MASS)\nmy.iris <- read.csv(\"../Examples/iris.txt\", header=TRUE)\n# Check assumptions and determine if variance matrices are different.\nlibrary(mvoutlier)\nlibrary(car)\n# first, get residuals\nmvres <- as.data.frame(residuals(manova(cbind(sl,sw,pl,pw) ~ spp, my.iris)))\nnames(mvres) <- c(\"esl\",\"esw\",\"epl\",\"epw\")\noutl <- aq.plot(mvres, delta=qchisq(1-0.05/150, df=4)) # only one using Bonferroni correction. LIB.\n\n# Visualize multivariate distribution\nmy.iris <- cbind(my.iris, mvres)\nmy.iris$color <- \"orange\"\nmy.iris$color[my.iris$spp==\"setosa\"] <- \"blue\"\nmy.iris$color[my.iris$spp==\"virginica\"] <- \"green\"\nlibrary(rgl)\nopen3d()\n# The following chiunk can be repeated for all combinations of the 4 characteristics of the flowers.\nplot3d(my.iris$esl,my.iris$esw,my.iris$epl, type=\"s\", col=my.iris$color, size=1) # plot residuals\n\ncov678setosa <- cov(my.iris[my.iris$spp==\"setosa\",6:8]) # calculate covariances for ellipses\ncov678virginica <- cov(my.iris[my.iris$spp==\"virginica\",6:8])\ncov678versicolor <- cov(my.iris[my.iris$spp==\"versicolor\",6:8])\n\nmean678setosa <- apply(my.iris[my.iris$spp==\"setosa\",1:3],2,mean) # calculate centroids for ellipses\nmean678virginica <- apply(my.iris[my.iris$spp==\"virginica\",1:3],2,mean)\nmean678versicolor <- apply(my.iris[my.iris$spp==\"versicolor\",1:3],2,mean)\n\nplot3d(ellipse3d(cov678setosa), col=\"blue\",alpha=0.4, add=TRUE) # add ellipses to residuals\nplot3d(ellipse3d(cov678virginica), col=\"green\",alpha=0.4, add=TRUE)\nplot3d(ellipse3d(cov678versicolor), col=\"orange\",alpha=0.4, add=TRUE)\n\nplot3d(my.iris$sl,my.iris$sw,my.iris$pl, type=\"s\", col=my.iris$color, size=1) # plot original data\nplot3d(ellipse3d(cov678setosa, centre=mean678setosa), col=\"blue\",alpha=0.4, add=TRUE) # add ellipses to plot\nplot3d(ellipse3d(cov678virginica, centre=mean678virginica), col=\"green\",alpha=0.4, add=TRUE)\nplot3d(ellipse3d(cov678versicolor, centre=mean678versicolor), col=\"orange\",alpha=0.4, add=TRUE)\n\n\n# (repeat for other combinations of 3 out of 4 residuals)\n# Even without repeating, there is enough evidence that the variance covariance matrices are not homogeneous. Use quadratic discriminant functions.\n\nqdiris <- qda(x=my.iris[,1:4], grouping=my.iris$spp, prior=c(1,1,1)/3)\nstr(qdiris)\nsummary(qdiris)\nlibrary(klaR)\npartimat(spp ~ sl + sw + pl + pw, data=my.iris, method=\"qda\")\nqd.pred <- predict(qdiris, newdata=my.iris[,1:4], method=\"debiased\") # method corrects for unknown parameters of the posterior distribution.\nxtabs(~my.iris$spp+qd.pred$class) # shows results of classification of the training data.\nqd.pred2 <- predict(qdiris, newdata=my.iris[,1:4], method=\"debiased\", prior=c(0.1,0.00,0.9))\nxtabs(~my.iris$spp+qd.pred2$class)\n\n# Discriminant analysis with candisc package\nlibrary(candisc)\nmvmod <- lm(cbind(sl,sw,pl,pw) ~ spp, my.iris)\nsummary(mvmod)\nmvmod\nstr(mvmod)\ncd.mvmod <- candisc(mvmod)\nplot(cd.mvmod) # biplot ob observations and canonical variates\n\ncan1 <- cd.mvmod$scores$Can1 # extract canonical variables from candisc object\ncan2 <- cd.mvmod$scores$Can2\n\nmy.iris <- cbind(my.iris, can1, can2)\n\nsummary(lm(can1 ~ spp, my.iris))\nsummary(lm(can2 ~ spp, my.iris))\n\nlibrary(heplots)",
    "created" : 1394055200088.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4187657347",
    "id" : "68D04A63",
    "lastKnownWriteTime" : 1386553039,
    "path" : "~/Documents/TeachServ/CLASSES/AGR206/PLS206F13/RstudioPLS206/discAna.R",
    "project_path" : "discAna.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}