{
    "contents" : "## Using package multcomp for multiple comparisons and linear hypotheses\n\nlibrary(multcomp)\n\n## Example of ANCOVA with emphasis on interactions: filaree =====\n\nfilaree <- read(\"xmpl_filaree.csv\") # Make sure you have the correct path\nfilaree$Tgroup<-as.factor(filaree$Tgroup) # Tgroup should be a nominal variable\noptions(contrasts=c(\"contr.sum\", \"contr.poly\"))\nm1 <- lm(lnwt~Tgroup*day, data=filaree)\n\n## Create a matrix where each row is a set of coefficients to calculate\n## a linear combination of estimated parameters.\n## Check order of estimated coefficients first.\ncoef(m1)\nH0s <- rbind(B0 =        c(1,0,0,0,0,0),\n             dB01 =      c(0,1,0,0,0,0),\n             dB02 =      c(0,0,1,0,0,0),\n             dB03 =      c(0,-1,-1,0,0,0),\n             B11 =       c(0,0,0,1,1,0),\n             B13 =       c(0,0,0,1,-1,-1),\n             B11_B13 =   c(0,0,0,0,2,1),\n             Y1.37 =     c(1,1,0,37,37,0),\n             Y3.22 =     c(1,-1,-1,22,-22,-22),\n             Y1.37_Y3.22=c(0,2,1,15,59,22))\n## Create object with tests and ask for summary\ntH0s <- glht(m1, linfct = H0s)\nsummary(tH0s, test = univariate())\nsummary(tH0s, test = adjusted(\"bonferroni\"))\n\n## Simultaneous test of differences between relative growth rates (slopes)\nH01s <- rbind(B12_B11 =   c(0,0,0,0,-1,1),\n              B13_B11 =   c(0,0,0,0,-2,-1),\n              B13_B12 =   c(0,0,0,0,-1,-2))\ntH01s <- glht(m1, linfct = H01s)\nsummary(tH01s, test = adjusted(\"bonferroni\"))\n\n\n\n\n## Example of ANCOVA with mice litter weight data ======\n## The main reason for the covariates is correction before comparisons\n## No interactions are included as they are assumed to be nil.\ndata(\"litter\")\nhead(litter)\nhelp(litter) # read description of data set\n\n## There are two covariates that can be used to correct litter weight:\n## gestation time (gesstime) and number of pups (number)\n## Example from package help\n\n### fit ANCOVA model to data\namod <- aov(weight ~ dose + gesttime + number, data = litter)\n\n### define matrix of linear hypotheses for `dose'\ndoselev <- as.integer(levels(litter$dose))\n\n### create a named vector with number of observations in each group\nsummary(litter$dose)\nn <- summary(litter$dose) #creates a vector with 4 numbers labeled with dose levels\n\n### create K matrix with coeficients for linear hypotheses\n### otrend is ordinal trend, atrend is linear and ltrend is logarithmic\nK <- rbind(contrMat(n, \"Tukey\"),\n           otrend = c(-1.5, -0.5, 0.5, 1.5),\n           atrend = doselev - mean(doselev),\n           ltrend = log(1:4) - mean(log(1:4)))\n\n### set up multiple comparison or test object\nKht <- glht(amod, linfct = mcp(dose = K), alternative = \"less\")\n\n### cf. Westfall (1997, Table 2)\nsummary(Kht, test = univariate())\nsummary(Kht, test = adjusted(\"bonferroni\"))\nsummary(Kht, test = adjusted(\"Shaffer\"))\nsummary(Kht, test = adjusted(\"Westfall\"))\nsummary(Kht, test = adjusted(\"single-step\"))\n\n",
    "created" : 1350156210193.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "40|50|76|44|\n",
    "hash" : "4194642975",
    "id" : "2BF2F335",
    "lastKnownWriteTime" : 1350163740,
    "path" : "~/Documents/TeachServ/CLASSES/AGR206/PLS206F10/RstudioPLS206/LinearHyp.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}