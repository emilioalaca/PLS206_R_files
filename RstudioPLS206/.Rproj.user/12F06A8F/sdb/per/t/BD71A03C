{
    "contents" : "# Discriminant analysis using MASS\n#  Loosely based on http://www.statmethods.net/advstats/discriminant.html by  Robert I. Kabacoff\nlibrary(MASS)\nmy.seeds <- read.csv(\"../Examples/seedDA.txt\", header=TRUE)\n# Check assumptions and determine if variance matrices are different.\nlibrary(mvoutlier)\nlibrary(car)\n\ntseeds <- my.seeds[my.seeds$hold.out==0,]# first, get residuals\nmvres <- as.data.frame(residuals(manova(cbind(area,perimeter,length,width,area.per,len.wid) ~ spp, tseeds)))\nnames(mvres) <- c(\"area\",\"perimeter\",\"length\",\"width\",\"area.per\",\"len.wid\")\n# outl <- aq.plot(mvres, delta=qchisq(1-0.05/150, df=4)) # only one using Bonferroni correction. LIB.\n\n# Visualize multivariate distribution\ntseeds <- cbind(tseeds, mvres)\ntseeds$color <- \"orange\"\ntseeds$color[tseeds$spp==\"brho\"] <- \"blue\"\ntseeds$color[tseeds$spp==\"brma\"] <- \"green\"\nlibrary(rgl)\nopen3d()\n# The following chunk can be repeated for all combinations of the 4 characteristics of the flowers.\n\nnames(tseeds)[9:14] <- paste(names(tseeds)[9:14],\".res\",sep=\"\")\nplot3d(tseeds$area.per.res,tseeds$length.res,tseeds$width.res, type=\"s\", col=tseeds$color, size=1) # plot residuals\n\ncov901brho <- cov(tseeds[tseeds$spp==\"brho\",9:11]) # calculate covariances for ellipses\ncov678virginica <- cov(tseeds[tseeds$spp==\"virginica\",6:8])\ncov678versicolor <- cov(tseeds[tseeds$spp==\"versicolor\",6:8])\n\nmean901brho <- apply(tseeds[tseeds$spp==\"brho\",2:4],2,mean) # calculate centroids for ellipses\nmean678virginica <- apply(tseeds[tseeds$spp==\"virginica\",1:3],2,mean)\nmean678versicolor <- apply(tseeds[tseeds$spp==\"versicolor\",1:3],2,mean)\n\nplot3d(ellipse3d(cov901brho), col=\"blue\",alpha=0.4, add=TRUE) # add ellipses to residuals\nplot3d(ellipse3d(cov678virginica), col=\"green\",alpha=0.4, add=TRUE)\nplot3d(ellipse3d(cov678versicolor), col=\"orange\",alpha=0.4, add=TRUE)\n\nplot3d(tseeds$sl,tseeds$sw,tseeds$pl, type=\"s\", col=tseeds$color, size=1) # plot original data\nplot3d(ellipse3d(cov678setosa, centre=mean678setosa), col=\"blue\",alpha=0.4, add=TRUE) # add ellipses to plot\nplot3d(ellipse3d(cov678virginica, centre=mean678virginica), col=\"green\",alpha=0.4, add=TRUE)\nplot3d(ellipse3d(cov678versicolor, centre=mean678versicolor), col=\"orange\",alpha=0.4, add=TRUE)\n\n\n# (repeat for other combinations of 3 out of 4 residuals)\n# Even without repeating, there is enough evidence that the variance covariance matrices are not homogeneous. Use quadratic discriminant functions.\n\nqdseeds <- qda(x=tseeds[,2:7], grouping=tseeds$spp, prior=c(1,1,1)/3)\nstr(qdseeds)\nsummary(qdseeds)\nlibrary(klaR)\npartimat(spp ~ sl + sw + pl + pw, data=my.seeds, method=\"qda\")\nqd.pred <- predict(qdseeds, newdata=my.seeds[,1:4], method=\"debiased\") # method corrects for unknown parameters of the posterior distribution.\nxtabs(~my.seeds$spp+qd.pred$class) # shows results of classification of the training data.\nqd.pred2 <- predict(qdseeds, newdata=my.seeds[,1:4], method=\"debiased\", prior=c(0.1,0.00,0.9))\nxtabs(~my.seeds$spp+qd.pred2$class)\n\n# Discriminant analysis with candisc package\nlibrary(candisc)\nmvmod <- lm(cbind(sl,sw,pl,pw) ~ spp, my.seeds)\nsummary(mvmod)\nmvmod\nstr(mvmod)\ncd.mvmod <- candisc(mvmod)\nplot(cd.mvmod) # biplot ob observations and canonical variates\n\ncan1 <- cd.mvmod$scores$Can1 # extract canonical variables from candisc object\ncan2 <- cd.mvmod$scores$Can2\n\nmy.seeds <- cbind(my.seeds, can1, can2)\n\nsummary(lm(can1 ~ spp, my.seeds))\nsummary(lm(can2 ~ spp, my.seeds))\n\nlibrary(heplots)",
    "created" : 1418748148124.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3482988429",
    "id" : "BD71A03C",
    "lastKnownWriteTime" : 1418750654,
    "path" : "~/Google Drive/PLS206F13/RstudioPLS206/HW09discAna.R",
    "project_path" : "HW09discAna.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}